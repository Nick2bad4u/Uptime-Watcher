/* Themed Button Styles */
/* stylelint-disable no-unknown-animations -- animation keyframes live in shared animations.css */

.themed-button {
    --themed-button-accent: color-mix(
        in srgb,
        var(--color-surface-overlay) 85%,
        transparent
    );
    --themed-button-foreground: var(--color-text-primary);

    position: relative;
    display: inline-flex;
    overflow: hidden;
    align-items: center;
    justify-content: center;
    border: 1px solid
        color-mix(in srgb, var(--color-border-secondary) 70%, transparent);
    border-radius: calc(var(--radius-md) + 0.15rem);
    background: linear-gradient(
        135deg,
        color-mix(in srgb, var(--themed-button-accent) 22%, transparent) 0%,
        color-mix(in srgb, var(--themed-button-accent) 12%, transparent) 55%,
        color-mix(in srgb, var(--color-surface-elevated) 85%, transparent) 100%
    );
    box-shadow:
        0 20px 36px
            color-mix(in srgb, var(--themed-button-accent) 18%, transparent),
        var(--shadow-elevation-1);
    color: var(--themed-button-foreground);
    cursor: pointer;
    font-weight: var(--font-weight-medium);
    gap: var(--spacing-xs);
    text-align: center;
    /*
     * Use a 3D transform to keep the button on a composited layer.
     *
     * @remarks
     * Prevents occasional one-frame text rasterization glitches when the
     * button transitions between hover/active/focus states.
     */
    transform: translate3d(0, 0, 0);
    transition:
        transform var(--transition-normal),
        box-shadow var(--transition-normal),
        color var(--transition-normal),
        border-color var(--transition-normal);
    white-space: nowrap;

    &::after {
        position: absolute;
        border-radius: inherit;
        background: linear-gradient(
            135deg,
            color-mix(in srgb, var(--themed-button-accent) 28%, transparent) 0%,
            color-mix(in srgb, var(--themed-button-accent) 8%, transparent) 100%
        );
        content: "";
        inset: 0;
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
        transition:
            opacity var(--transition-fast),
            transform var(--transition-fast);
    }

    @media (prefers-reduced-motion: reduce) {
        transition: none;

        &::after {
            transition: none;
        }
    }

    &:hover,
    &:focus-visible {
        box-shadow:
            0 26px 48px
                color-mix(in srgb, var(--themed-button-accent) 24%, transparent),
            var(--shadow-elevation-2);
        transform: translate3d(0, -1px, 0);

        &::after {
            opacity: 0.18;
            transform: scale(1.02);
        }
    }

    &:active {
        box-shadow: var(--shadow-elevation-1);
        transform: translate3d(0, 0, 0);
        transition:
            transform var(--transition-fast),
            box-shadow var(--transition-fast);

        @media (prefers-reduced-motion: reduce) {
            transition: none;
        }
    }

    &:focus-visible {
        box-shadow:
            0 0 0 1px
                color-mix(in srgb, var(--shadow-inverse-color) 10%, transparent),
            0 0 0 3px
                color-mix(in srgb, var(--themed-button-accent) 70%, transparent),
            0 24px 52px
                color-mix(in srgb, var(--themed-button-accent) 26%, transparent);
        transform: translate3d(0, -1px, 0);
    }
}

.themed-button:disabled,
.themed-button--loading,
.themed-input:disabled,
.themed-select:disabled {
    cursor: not-allowed;
    opacity: 0.6;
}

.themed-button:disabled {
    box-shadow: var(--shadow-elevation-1);
    transform: translate3d(0, 0, 0);

    &::after {
        display: none;
    }
}

.themed-button--primary {
    --themed-button-accent: var(--color-primary-500);
    --themed-button-foreground: color-mix(
        in srgb,
        var(--color-primary-500) 18%,
        #ffffff 82%
    );

    border-color: color-mix(in srgb, var(--color-primary-500) 55%, transparent);
}

.themed-button--secondary {
    --themed-button-accent: color-mix(
        in srgb,
        var(--color-border-secondary) 45%,
        transparent
    );
    --themed-button-foreground: var(--color-text-primary);

    border-color: color-mix(
        in srgb,
        var(--color-border-secondary) 70%,
        transparent
    );
}

.themed-button--success {
    --themed-button-accent: var(--color-success);
    --themed-button-foreground: color-mix(
        in srgb,
        var(--color-success) 25%,
        #ffffff 75%
    );

    border-color: color-mix(in srgb, var(--color-success) 55%, transparent);
}

.themed-button--warning {
    --themed-button-accent: var(--color-warning);
    --themed-button-foreground: color-mix(
        in srgb,
        var(--color-warning) 25%,
        #ffffff 75%
    );

    border-color: color-mix(in srgb, var(--color-warning) 55%, transparent);
}

.themed-button--error {
    --themed-button-accent: var(--color-error);
    --themed-button-foreground: color-mix(
        in srgb,
        var(--color-error) 25%,
        #ffffff 75%
    );

    border-color: color-mix(in srgb, var(--color-error) 55%, transparent);
}

.themed-button--ghost {
    --themed-button-accent: color-mix(
        in srgb,
        var(--color-border-secondary) 20%,
        transparent
    );
    --themed-button-foreground: color-mix(
        in srgb,
        var(--color-text-secondary) 88%,
        #ffffff 12%
    );

    border-color: color-mix(
        in srgb,
        var(--color-border-secondary) 35%,
        transparent
    );
    background: transparent;
    box-shadow: none;
}

.themed-button--size-xs {
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: var(--font-size-xs);
}

.themed-button--size-sm {
    padding: var(--spacing-sm) var(--spacing-md);
    font-size: var(--font-size-sm);
}

.themed-button--size-md {
    padding: var(--spacing-md) var(--spacing-lg);
    font-size: var(--font-size-base);
}

.themed-button--size-lg {
    padding: var(--spacing-lg) var(--spacing-xl);
    font-size: var(--font-size-lg);
}

.themed-button--xs {
    padding: 0.375rem 0.75rem;
    border-radius: var(--border-radius-sm);
    font-size: 0.75rem;
    line-height: 1rem;
}

.themed-button--sm {
    padding: 0.5rem 1rem;
    border-radius: var(--border-radius-md);
    font-size: 0.875rem;
    line-height: 1.25rem;
}

.themed-button--md {
    padding: 0.625rem 1.25rem;
    border-radius: var(--border-radius-md);
    font-size: 1rem;
    line-height: 1.5rem;
}

.themed-button--lg {
    padding: 0.875rem 1.75rem;
    border-radius: var(--border-radius-lg);
    font-size: 1.125rem;
    line-height: 1.75rem;
}

.themed-button--full-width,
.themed-button.full-width,
.w-full {
    inline-size: 100%;
}

.themed-button--icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    aspect-ratio: 1;

    & .button-icon {
        font-size: 1.125rem;
        line-height: 1;
    }
}

.themed-button__icon {
    display: flex;
    align-items: center;
    font-size: 1.125rem;
    line-height: 1;
}

/* Enhanced Button Loading State */
.themed-button__loading {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.themed-button__spinner {
    border: 2px solid transparent;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    block-size: 16px;
    border-block-start: 2px solid currentcolor;
    inline-size: 16px;

    @media (prefers-reduced-motion: reduce) {
        animation: none;
    }
}

.icon-button {
    position: relative;
    display: inline-flex;
    overflow: hidden;
    align-items: center;
    justify-content: center;
    border-radius: var(--border-radius-md);
    block-size: 2.5rem;
    inline-size: 2.5rem;
    transition:
        box-shadow var(--transition-normal),
        transform var(--transition-normal);
    & .icon {
        font-size: 1.125rem;
        line-height: 1;
        transition: transform var(--transition-normal);
    }

    &:is(:hover, :focus, :focus-visible) .icon {
        transform: scale(1.1);
    }

    &::before {
        position: absolute;
        border-radius: inherit;
        background: currentcolor;
        content: "";
        inset: 0;
        opacity: 0;
        transition: opacity var(--transition-normal);
    }

    &:is(:hover, :focus, :focus-visible)::before {
        opacity: 0.1;
    }

    &:active::before {
        opacity: 0.2;
    }

    &:focus-visible {
        box-shadow: 0 0 0 2px
            color-mix(in srgb, var(--color-primary-500) 75%, transparent);
        transform: translateY(-1px);
    }

    @media (prefers-reduced-motion: reduce) {
        transition: none;

        & .icon {
            transition: none;
        }
        &::before {
            transition: none;
        }
    }
}

.button-micro {
    position: relative;
    overflow: hidden;

    &::after {
        position: absolute;
        border-radius: 50%;
        background: color-mix(
            in srgb,
            var(--shadow-inverse-color) 40%,
            transparent
        );
        block-size: 0;
        content: "";
        inline-size: 0;
        inset-block-start: 50%;
        inset-inline-start: 50%;
        opacity: 0;
        transform: translate(-50%, -50%);
        transition:
            opacity var(--transition-normal),
            transform var(--transition-normal),
            block-size var(--transition-fast),
            inline-size var(--transition-fast);

        @media (prefers-reduced-motion: reduce) {
            transition: none;
        }
    }

    &:active::after {
        block-size: 160%;
        inline-size: 160%;
        opacity: 0.25;
        transform: translate(-50%, -50%) scale(1.05);
    }
}
