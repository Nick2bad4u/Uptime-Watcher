/* Site Details Modal Layout */

.site-details-modal-overlay {
    position: fixed;
    z-index: calc(var(--z-index-modal, 90) + 4);
    display: flex;
    overflow: hidden;
    align-items: center;
    justify-content: center;
    padding: clamp(1.25rem, 0.75rem + 1.5vi, 3rem);
    backdrop-filter: blur(12px);
    background: rgb(0 0 0 / 65%);
    inset: 0;
}

/* Prevent body scroll when modal is open */
body:has(.site-details-modal-overlay) {
    overflow: hidden;
}

.site-details-modal {
    display: flex;
    flex-direction: column;
    animation: modal-slide-up 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    gap: clamp(1.2rem, 0.9rem + 1vi, 2rem);
    inline-size: 100%;
    max-block-size: 90vb; /* Ensure it doesn't exceed viewport height */
    min-block-size: 0;

    @media screen and (prefers-reduced-motion: reduce) {
        display: flex;
        flex-direction: column;
        animation: none;
        gap: clamp(1.2rem, 0.9rem + 1vi, 2rem);
        inline-size: 100%;
        max-block-size: 90vb; /* Ensure it doesn't exceed viewport height */
        min-block-size: 0;
    }
}

@keyframes modal-slide-up {
    from {
        opacity: 0;
        transform: translateY(20px) scale(0.98);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.site-details-modal__actions {
    align-self: flex-end;
}

.site-details-modal__close {
    border-color: color-mix(in srgb, var(--color-primary-500) 32%, transparent);
}

.site-details-modal__body {
    position: relative;
    z-index: 1;
    display: flex;
    overflow: hidden; /* Contain the scroll wrapper */
    flex: 1; /* Take available space */
    flex-direction: column;
    gap: 0; /* Remove gap as wrapper handles it */
    inline-size: 100%;
    min-block-size: 0;
}

.site-details-modal__content-wrapper {
    display: flex;
    flex: 1 1 auto;
    flex-direction: column;
    gap: clamp(1.25rem, 1rem + 1vi, 2rem); /* Add gap between elements inside */
    min-block-size: 0;
    overflow-block: auto; /* Explicit vertical scroll */
    overflow-inline: hidden;
    overscroll-behavior: contain;
    padding-inline-end: 0.625rem; /* Spacing for scrollbar */
    scrollbar-gutter: stable;
}

.site-details-modal__sentinel {
    block-size: 1px;
    inline-size: 100%;
    pointer-events: none;
}

.site-details-modal__content {
    display: flex;
    flex: 1;
    flex-direction: column;
    border: 1px solid
        color-mix(in srgb, var(--color-border-secondary) 52%, transparent);
    border-radius: 1.125rem; /* More rounded */
    background: linear-gradient(
        145deg,
        color-mix(in srgb, var(--color-surface-elevated) 97%, transparent) 0%,
        color-mix(
                in srgb,
                var(--color-surface-overlay) 84%,
                var(--color-primary-500) 6%
            )
            100%
    );
    box-shadow:
        inset 0 0 0 1px rgb(255 255 255 / 6%),
        0 28px 56px -14px rgb(0 0 0 / 22%); /* Softer, deeper shadow */
    gap: clamp(1.125rem, 0.875rem + 0.9vi, 1.75rem);
    min-block-size: auto;

    &.dark {
        border-color: color-mix(
            in srgb,
            var(--color-border-secondary) 60%,
            transparent
        );
        background: linear-gradient(
            145deg,
            color-mix(in srgb, var(--color-surface-overlay) 97%, transparent) 0%,
            color-mix(
                    in srgb,
                    var(--color-surface-overlay) 80%,
                    var(--color-primary-500) 10%
                )
                100%
        );
        box-shadow:
            inset 0 0 0 1px rgb(255 255 255 / 3%),
            0 28px 56px -14px rgb(0 0 0 / 45%);
    }
}

@media (width <= 1024px) {
    .site-details-modal__body {
        gap: clamp(1rem, 0.85rem + 0.7vi, 1.6rem);
    }
}

@media (width <= 640px) {
    .site-details-modal-overlay {
        padding: clamp(0.75rem, 0.4rem + 1vi, 1.5rem);
    }

    .site-details-modal {
        gap: 1rem;
    }
}
