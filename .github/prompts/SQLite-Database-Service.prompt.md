---
mode: "agent"
tools: ['Best Tools']
description: "Create SQLite database service with TypeScript and migrations"
---

Create SQLite database service for: ${input:entityName}

Requirements:

- TypeScript implementation with strict typing
- SQLite integration with better-sqlite3
- Database migration system
- Connection pooling and management
- Transaction support with rollback
- Type-safe query builders
- Performance optimization
- Comprehensive error handling

Entity Management:

- Strong TypeScript interfaces for entities
- CRUD operations with type safety
- Relationship management
- Data validation and constraints
- Soft delete functionality
- Audit trail capabilities
- Bulk operations support

Migration System:

- Sequential migration numbering
- Up and down migration scripts
- Schema version tracking
- Data transformation utilities
- Rollback capabilities
- Migration validation
- Performance impact assessment

Query Building:

- Type-safe query construction
- Parameter binding and sanitization
- Complex query support (joins, subqueries)
- Pagination and sorting
- Search and filtering
- Aggregation functions
- Index optimization

Transaction Management:

- ACID compliance
- Nested transaction support
- Automatic rollback on errors
- Transaction performance monitoring
- Deadlock detection and recovery
- Connection management during transactions

Performance Optimization:

- Query optimization and indexing
- Connection pooling
- Prepared statement caching
- Batch operation support
- Memory usage optimization
- Query performance monitoring
- Database maintenance utilities

Error Handling:

- SQLite error code mapping
- Constraint violation handling
- Connection error recovery
- Data corruption detection
- Backup and recovery procedures
- Error logging and reporting

Security Features:

- SQL injection prevention
- Data encryption at rest
- Access control and permissions
- Audit logging
- Sensitive data handling
- Database integrity checks

Backup and Recovery:

- Automated backup procedures
- Point-in-time recovery
- Database integrity verification
- Export and import utilities
- Disaster recovery planning
- Data migration tools

Integration:

- Service layer integration
- Repository pattern implementation
- Event system integration
- Logging service coordination
- Configuration management
- Health check endpoints
